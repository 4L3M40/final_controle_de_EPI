{% extends "base.html" %}
{% block title %}{% if is_create %}Novo{% else %}Editar{% endif %} Colaborador{% endblock %}

{% block content %}
<h1>{% if is_create %}Novo{% else %}Editar{% endif %} Colaborador</h1>

{# Resumo de erros amig√°vel #}
{% if form.errors %}
  <div class="form-errors">
    <strong>Verifique os erros abaixo:</strong>
    <ul>
      {% for field in form %}
        {% for error in field.errors %}
          <li><strong>{{ field.label }}:</strong> {{ error }}</li>
        {% endfor %}
      {% endfor %}
      {% for error in form.non_field_errors %}
        <li>{{ error }}</li>
      {% endfor %}
    </ul>
  </div>
{% endif %}

<form method="post">
  {% csrf_token %}
  {{ form.as_p }}

  <div class="actions">
    <button class="btn" type="submit">Salvar</button>
    <a class="btn btn-danger" href="{% url 'colaboradores:list' %}">Cancelar</a>
  </div>
</form>

{# Foco no primeiro campo (ou no primeiro com erro) #}
<script>
  (function () {
    const err = document.querySelector('.form-errors');
    if (err) {
      // tenta focar no primeiro input com aria-invalid (Django adiciona no widget) ou no primeiro input
      const firstErr = document.querySelector('[aria-invalid="true"], input, select, textarea');
      if (firstErr) firstErr.focus();
    } else {
      const first = document.querySelector('form input, form select, form textarea');
      if (first) first.focus();
    }
  })();
</script>
{% endblock %}
